@using WebApplication.Models
@model Dictionary<DomainModel.Types.GameType, ChartJsData<int>>
<div class="card">
    <div class="card-title">
        SR Evolution
    </div>
    <div class="card-content">
        <ul class="collapsible">
            <li class="active">
                <div class="collapsible-header">Damage</div>
                <div class="collapsible-body">
                    <canvas id="sr-evolution-dps" data-key="Damage"></canvas>
                </div>
            </li>
            <li>
                <div class="collapsible-header">Support</div>
                <div class="collapsible-body">
                    <canvas id="sr-evolution-support" data-key="Support"></canvas>
                </div>
            </li>
            <li>
                <div class="collapsible-header">Tank</div>
                <div class="collapsible-body">
                    <canvas id="sr-evolution-tank" data-key="Tank"></canvas>
                </div>
            </li>
            <li>
                <div class="collapsible-header">Open Queue</div>
                <div class="collapsible-body">
                    <canvas id="sr-evolution-oq" data-key="OpenQueue"></canvas>
                </div>
            </li>
        </ul>
    </div>
</div>

<script type="text/javascript">
    (function() {
        
        const SR_EVOLUTIONS_OPTIONS = {
            responsive: true,
            elements: {
                point: {
                    radius: 0
                }   
            },
            interaction: {
                intersect: false,
                mode: 'index',
            },
            plugins: {
                tooltip: {
                    position: "nearest",
                }  
            }
        }
        
        let SrEvolutionLineCtx = [
            document.getElementById("sr-evolution-dps")?.getContext("2d"),
            document.getElementById("sr-evolution-support")?.getContext("2d"),
            document.getElementById("sr-evolution-tank")?.getContext("2d"),
            document.getElementById("sr-evolution-oq")?.getContext("2d")
        ]
       
        let DataList = @Json.Serialize(Model) ?? [];
        
        for (let i in SrEvolutionLineCtx) {
            let type = SrEvolutionLineCtx[i].canvas.dataset.key;
            if (typeof DataList[type] === "undefined") {
                SrEvolutionLineCtx[i].canvas.parentElement.innerHTML = "No data found for this role";
                continue;
            }
            new Chart(SrEvolutionLineCtx[i], {
                type: 'line',
                data: DataList[type],
                options: SR_EVOLUTIONS_OPTIONS
            })
        }
    })();
</script>