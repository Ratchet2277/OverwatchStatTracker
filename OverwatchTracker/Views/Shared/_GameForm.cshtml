@using DomainModel
@model DomainModel.Game

@using (Html.BeginForm(controllerName: "Game", actionName: Model.Id == 0 ? "Create" : "Edit"))
{
    @if (Model.Id != 0)
    {
        @Html.HiddenFor(g => g.Id)
    }
    <div class="modal-content row" id="add-game">
        <h4>Ajouter une game</h4>
        <div class="input-field col s12 m6">
            <select name="Game.NewMap" id="Game_Map">
                <option v-for="map in maps" v-bind:value="map.id" :selected="map.id == @Model.Map?.Id">{{ map.name }}</option>
            </select>
            <label for="Game_Map">Map</label>
        </div>

        <div class="input-field col s12 m6">
            <select name="Game.Type" id="Game_Type"
                    v-model="selectedRole"
                    v-on:change="updateHeroList">
                <option v-for="(role, id) in roles" v-bind:value="id" :selected="id == @Model.Type">{{ role }}</option>
            </select>
            <label for="Game_Type">Type</label>
        </div>

        <div class="input-field col s12 m6">
            <select name="Game.NewHeroes" id="Game_Heroes" multiple>
                <option v-for="hero in heroes" v-bind:value="hero.id" v-bind:data-icon="hero.imageUrl" class="right" selected="@(Json.Serialize(Model.Heroes.Select(h => h.Id).ToArray())).includes(hero.id">{{ hero.name }}</option>
            </select>
            <label for="Game_Heroes">Hero</label>
        </div>
        <div class="input-field col s12 m6">
            @Html.TextBoxFor(g => g.Sr, new {type = "number", min = 0, max = 5000})
            @Html.LabelFor(g => g.Sr)
        </div>

        <div class="input-field col s12">
            <label for="Game_SquadMembers">Pré-mate</label>
            <select name="Game.NewSquadMembers" id="Game_SquadMembers"
                    class="select2 browser-default"
                    data-tags="true"
                    multiple
                    data-width="100%"
                    data-ajax--url="/SquadMember/Search">
                @foreach (var squadMember in Model.SquadMembers)
                {
                    <option selected value="@squadMember.Name">@squadMember.Name</option>
                }
            </select>
        </div>
        <div class="input-field col s12 m6">
            @Html.TextBoxFor(g => g.AllieScore, new {type = "number", min = 0})
            @Html.LabelFor(g => g.AllieScore)
        </div>
        <div class="input-field col s12 m6">
            @Html.TextBoxFor(g => g.EnemyScore, new {type = "number", min = 0})
            @Html.LabelFor(g => g.EnemyScore)
        </div>
        <div class="col s12 center">
            <button class="btn wave-effect">Enregistrer</button>
        </div>
    </div>
}